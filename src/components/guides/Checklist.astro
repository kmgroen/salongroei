---
interface Props {
  title?: string;
  items: string[];
}

const { title, items } = Astro.props;
---

<div class="bg-gradient-to-br from-primary/5 to-primary/10 rounded-xl p-6 my-8">
  {title && (
    <h3 class="font-display text-xl font-black text-expert-navy dark:text-white mb-4 flex items-center gap-2">
      <span class="material-symbols-outlined text-primary">checklist</span>
      {title}
    </h3>
  )}

  <ul class="space-y-3">
    {items.map((item, index) => (
      <li class="flex items-start gap-3 group">
        <label class="flex items-start gap-3 cursor-pointer flex-1">
          <input
            type="checkbox"
            id={`checklist-item-${index}`}
            class="mt-1 w-5 h-5 rounded border-2 border-primary/30 text-primary focus:ring-2 focus:ring-primary/50 cursor-pointer"
          />
          <span class="text-sm text-expert-navy dark:text-white flex-1 group-has-[:checked]:line-through group-has-[:checked]:text-expert-navy/40">
            {item}
          </span>
        </label>
      </li>
    ))}
  </ul>

  <div class="mt-6 pt-4 border-t border-primary/20">
    <div class="flex items-center justify-between text-sm">
      <span class="text-expert-navy/60 dark:text-white/60">
        <span id="checklist-progress">0</span> / {items.length} voltooid
      </span>
      <button
        id="reset-checklist"
        class="text-primary hover:text-primary/80 font-semibold flex items-center gap-1 transition-colors"
      >
        <span class="material-symbols-outlined text-sm">refresh</span>
        Reset
      </button>
    </div>
  </div>
</div>

<script>
  function setupChecklist() {
    const checkboxes = document.querySelectorAll('input[type="checkbox"][id^="checklist-item-"]');
    const progressSpan = document.getElementById('checklist-progress');
    const resetButton = document.getElementById('reset-checklist');

    function updateProgress() {
      const checked = Array.from(checkboxes).filter((cb: any) => cb.checked).length;
      if (progressSpan) {
        progressSpan.textContent = checked.toString();
      }
    }

    checkboxes.forEach((checkbox) => {
      checkbox.addEventListener('change', updateProgress);
    });

    if (resetButton) {
      resetButton.addEventListener('click', () => {
        checkboxes.forEach((cb: any) => {
          cb.checked = false;
        });
        updateProgress();
      });
    }

    // Initialize progress
    updateProgress();
  }

  // Run on page load
  setupChecklist();

  // Re-run on navigation (for Astro view transitions)
  document.addEventListener('astro:page-load', setupChecklist);
</script>
